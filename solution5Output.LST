SQL> 
SQL> /* ==============================================
SQL> Student Name: Nur Suhaira
SQL> Student Number: 5841549
SQL> Description: Assignment 2 Task 5
SQL> Date written: 9th May 2018
SQL> ================================================
SQL> 
SQL> ====================Qn 5(a)=====================*/
SQL> 
SQL> -- Drop tables previously created
SQL> -- @C:\Nur_Suhaira_5841549_A2\DropDbPartyChef.sql;
SQL> 
SQL> -- Execute the script CreateDbPartyChef.sql to create
SQL> -- a sample database.
SQL> -- The database contains information about
SQL> -- the parties held by clients and the chefs engaged
SQL> -- in parties. The specialities of chefs are also stored
SQL> -- in the sample database
SQL> 
SQL> @C:\Nur_Suhaira_5841549_A2\CreateDbPartyChef.sql;
SQL> set echo on
SQL> /* spool C:\Users\Sionggo\SIM\CSCI235\SamleDatabase\PartyAndChef\Script\createdbdpartycheflog.txt
SQL> 
SQL>  Sample database for a Party, Chef, and Client information
SQL> */
SQL> -- Drop all tables if tables have been created earlier
SQL> DROP TABLE CHEF CASCADE CONSTRAINT purge;

Table dropped.

SQL> DROP TABLE SPECIALITY CASCADE CONSTRAINT purge;

Table dropped.

SQL> DROP TABLE PARTY CASCADE CONSTRAINT purge;

Table dropped.

SQL> DROP TABLE CLIENT CASCADE CONSTRAINT purge;

Table dropped.

SQL> DROP TABLE FEEDBACK CASCADE CONSTRAINT purge;

Table dropped.

SQL> DROP TABLE CHEFPARTY CASCADE CONSTRAINT purge;

Table dropped.

SQL> --
SQL> -- Create table CHEF
SQL> CREATE TABLE CHEF (
  2  ChefFName		     VARCHAR2(25)
  3  	     CONSTRAINT      Chef_ChefFName_NotNull NOT NULL,
  4  ChefLName		     VARCHAR2(25)
  5  	     CONSTRAINT      Chef_ChefLName_NotNull NOT NULL,
  6  Sex			     VARCHAR2(1)
  7  	     CONSTRAINT      Chef_ChefSex_NotNull    NOT NULL,
  8  	     CONSTRAINT Chef_Sex_Check check (Sex in ('F', 'M')),
  9  DOB			     DATE,
 10  CONSTRAINT Chef_Pk PRIMARY KEY (ChefFName, ChefLName)
 11  );

Table created.

SQL> 
SQL> -- Insert sample records to CHEF
SQL> INSERT INTO CHEF VALUES ('Daniel', 'Lee', 'M', '10 March 1968');

1 row created.

SQL> INSERT INTO CHEF VALUES ('Brian', 'Miller', 'M', '4 September 1975');

1 row created.

SQL> INSERT INTO CHEF VALUES ('Eric', 'Harris', 'M', '15 April 1992');

1 row created.

SQL> INSERT INTO CHEF VALUES ('Andrew', 'Smith', 'M', '25 July 1980');

1 row created.

SQL> INSERT INTO CHEF VALUES ('Jerry', 'Walker', 'M', '23 February 1992');

1 row created.

SQL> INSERT INTO CHEF VALUES ('Dennis', 'Jenkins', 'M', '19 October 1989');

1 row created.

SQL> INSERT INTO CHEF VALUES ('Victor', 'Myers', 'M', '1 May 1985');

1 row created.

SQL> INSERT INTO CHEF VALUES ('Helen', 'Perry', 'F', '30 March 1985');

1 row created.

SQL> INSERT INTO CHEF VALUES ('Sarah', 'Foster', 'F', '11 November 1989');

1 row created.

SQL> INSERT INTO CHEF VALUES ('Pamela', 'Miyuki', 'F', '12 June 1988');

1 row created.

SQL> INSERT INTO CHEF VALUES ('Donald', 'Lewis', 'M', '18 August 1980');

1 row created.

SQL> INSERT INTO CHEF VALUES ('Anita', 'Baker', 'F','27 September 1981');

1 row created.

SQL> 
SQL> 
SQL> -- Crreate table SPECIALITY
SQL> CREATE TABLE SPECIALITY (
  2  ChefFName		     VARCHAR2(25)
  3  	     CONSTRAINT      Speciality_ChefFName_NotNull NOT NULL,
  4  ChefLName		     VARCHAR2(25)
  5  	     CONSTRAINT      Speciality_ChefLName_NotNull NOT NULL,
  6  Speciality 	     VARCHAR2(50)
  7  	     CONSTRAINT      Speciality_Speciality_NotNull NOT NULL,
  8  CONSTRAINT      Speciality_Pk PRIMARY KEY (ChefFName, ChefLName, Speciality),
  9  CONSTRAINT      Speciality_FK FOREIGN KEY (ChefFName, ChefLName) REFERENCES CHEF (ChefFName, ChefLName)
 10  );

Table created.

SQL> 
SQL> -- Insert sample records to SPECIALITY
SQL> INSERT INTO SPECIALITY VALUES ('Daniel', 'Lee', 'Chinese Cuisine');

1 row created.

SQL> INSERT INTO SPECIALITY VALUES ('Daniel', 'Lee', 'Japanese Cuisine');

1 row created.

SQL> INSERT INTO SPECIALITY VALUES ('Eric', 'Harris', 'Italian Cuisine');

1 row created.

SQL> INSERT INTO SPECIALITY VALUES ('Andrew', 'Smith', 'Italian Cuisine');

1 row created.

SQL> INSERT INTO SPECIALITY VALUES ('Andrew', 'Smith', 'French Cuisine');

1 row created.

SQL> INSERT INTO SPECIALITY VALUES ('Jerry', 'Walker', 'Chinese Cuisine');

1 row created.

SQL> INSERT INTO SPECIALITY VALUES ('Jerry', 'Walker', 'Thai Cuisine');

1 row created.

SQL> INSERT INTO SPECIALITY VALUES ('Helen', 'Perry', 'Australian Cuisine');

1 row created.

SQL> INSERT INTO SPECIALITY VALUES ('Victor', 'Myers', 'German Cuisine');

1 row created.

SQL> INSERT INTO SPECIALITY VALUES ('Sarah', 'Foster', 'Japanese Cuisine');

1 row created.

SQL> INSERT INTO SPECIALITY VALUES ('Sarah', 'Foster', 'American Cuisine');

1 row created.

SQL> INSERT INTO SPECIALITY VALUES ('Pamela', 'Miyuki', 'Japanese Cuisine');

1 row created.

SQL> INSERT INTO SPECIALITY VALUES ('Brian', 'Miller', 'Mexican Cuisine');

1 row created.

SQL> INSERT INTO SPECIALITY VALUES ('Dennis', 'Jenkins', 'Indonesian Cuisine');

1 row created.

SQL> INSERT INTO SPECIALITY VALUES ('Dennis', 'Jenkins', 'Indian Cuisine');

1 row created.

SQL> INSERT INTO SPECIALITY VALUES ('Helen', 'Perry', 'Malaysian Cuisine');

1 row created.

SQL> INSERT INTO SPECIALITY VALUES ('Donald', 'Lewis', 'Dutch Cuisine');

1 row created.

SQL> INSERT INTO SPECIALITY VALUES ('Anita', 'Baker', 'New Zealand Cuisine');

1 row created.

SQL> 
SQL> -- Create table CLIENT
SQL> CREATE TABLE CLIENT (
  2  ClientFName	     VARCHAR2(25)
  3  	     CONSTRAINT      Client_ClientFName_NotNull NOT NULL,
  4  ClientLName	     VARCHAR2(25)
  5  	     CONSTRAINT Client_ClientLName_NotNull NOT NULL,
  6  Phone			     VARCHAR2(25),
  7  ClientEmail	     VARCHAR2(75)
  8  	     CONSTRAINT Client_ClientEmail_NotNull NOT NULL,
  9  	     CONSTRAINT Client_ClientEmail_Unique UNIQUE (ClientEmail),
 10  Sex			     VARCHAR2(1)
 11  	     CONSTRAINT Client_Sex_NotNull NOT NULL,
 12  	     CONSTRAINT Client_Sex_Check check (Sex in ('M','F')),
 13  CONSTRAINT      Client_PK PRIMARY KEY (ClientFName, ClientLName)
 14  );

Table created.

SQL> 
SQL> -- Insert sample records to CLIENT
SQL> INSERT INTO CLIENT VALUES ('Ronald', 'Lewis', '92379431', 'rlewis@gmail.com', 'M');

1 row created.

SQL> INSERT INTO CLIENT VALUES ('Paul', 'Anderson', '82316329', 'panderson@yahoo.com', 'M');

1 row created.

SQL> INSERT INTO CLIENT VALUES ('Jennifer', 'Baker', '81230843', 'jbaker@yahoo.com', 'F');

1 row created.

SQL> INSERT INTO CLIENT VALUES ('Carol', 'Martin', '93842319', 'cmartin@gmail.com', 'F');

1 row created.

SQL> INSERT INTO CLIENT VALUES ('Ruth', 'Jones', '91284502', 'rjones@gmail.com', 'F');

1 row created.

SQL> INSERT INTO CLIENT VALUES ('John', 'Young', '81284239', 'jyoung@gmail.com', 'M');

1 row created.

SQL> INSERT INTO CLIENT VALUES ('Thomas', 'Taylor', '91874259', 'ttaylor@yahoo.com', 'M');

1 row created.

SQL> INSERT INTO CLIENT VALUES ('Brian', 'Parker', '92763914', 'bparker@yahoo.com', 'M');

1 row created.

SQL> INSERT INTO CLIENT VALUES ('Jeff', 'Collins', '88239468', 'jcollins@gmail.com', 'M');

1 row created.

SQL> INSERT INTO CLIENT VALUES ('Kimberly', 'Brown', '93285430', 'kbrown@gmail.com', 'F');

1 row created.

SQL> INSERT INTO CLIENT VALUES ('Susan', 'Lee', '84821429', 'slee@gmail.com', 'F');

1 row created.

SQL> INSERT INTO CLIENT VALUES ('Kevin', 'Gonzalez', '91038255', 'kgonzalez@gmail.com', 'M');

1 row created.

SQL> INSERT INTO CLIENT VALUES ('Michelle', 'Moore', '82378263', 'mmoore@gmail.com', 'F');

1 row created.

SQL> INSERT INTO CLIENT VALUES ('Deborah', 'Nelson', '93572183', 'dnelson@yahoo.com', 'F');

1 row created.

SQL> INSERT INTO CLIENT VALUES ('Betty', 'Lopez', '94218425', 'blopez@gmail.com', 'F');

1 row created.

SQL> INSERT INTO CLIENT VALUES ('Anthony', 'White', '81936738', 'awhite@gmail.com', 'M');

1 row created.

SQL> INSERT INTO CLIENT VALUES ('Kimberly', 'Scott', '92743898', 'kscott@gmail.com', 'F');

1 row created.

SQL> INSERT INTO CLIENT VALUES ('William', 'Young', '82479263', 'wyoung@gmail.com', 'M');

1 row created.

SQL> INSERT INTO CLIENT VALUES ('Charles', 'Carter', '93881688', 'ccarter@gmail.com', 'M');

1 row created.

SQL> INSERT INTO CLIENT VALUES ('Karen', 'Hill', '81498278', 'khill@gmail.com', 'F');

1 row created.

SQL> 
SQL> 
SQL> CREATE TABLE PARTY (
  2  PartyDateTime   TIMESTAMP
  3  	     CONSTRAINT      Party_PartyDateTime_NotNull NOT NULL,
  4  Location		     VARCHAR2(75)
  5  	     CONSTRAINT Party_Location_NotNull NOT NULL,
  6  ClientFName     VARCHAR2(25)
  7  	     CONSTRAINT Party_ClientFName_NotNull NOT NULL,
  8  ClientLName     VARCHAR2(25)
  9  	     CONSTRAINT Party_ClientLName_NotNull NOT NULL,
 10  CONSTRAINT      Party_Pk PRIMARY KEY (PartyDateTime, Location),
 11  CONSTRAINT Party_Fk FOREIGN KEY (ClientFName, ClientLName) references CLIENT (ClientFName, ClientLName)
 12  );

Table created.

SQL> 
SQL> INSERT INTO PARTY VALUES (systimestamp+3+(1/24/60)*50, '14 West Coast Park Road', 'Kevin', 'Gonzalez');

1 row created.

SQL> INSERT INTO PARTY VALUES (systimestamp+25+(1/24/60)*25, '38 Namly Grove', 'Betty', 'Lopez');

1 row created.

SQL> INSERT INTO PARTY VALUES (systimestamp+7+(1/24/60)*10, 'Orchid Room, Level 2, Raffles Hotel', 'Michelle', 'Moore');

1 row created.

SQL> INSERT INTO PARTY VALUES (systimestamp+14+(1/24/60)*20, 'Grand Hall, Level 2, MBS', 'Kevin', 'Gonzalez');

1 row created.

SQL> INSERT INTO PARTY VALUES (systimestamp+3+(1/24/60)*50, 'Grand Hall, Level 2, MBS', 'Anthony', 'White');

1 row created.

SQL> INSERT INTO PARTY VALUES (systimestamp+21+(1/24/60)*250, 'Grand Hall, Level 2, Mandarin Orchard Hotel', 'Kevin', 'Gonzalez');

1 row created.

SQL> INSERT INTO PARTY VALUES (systimestamp-2+(1/24/60)*10, '38 Namly Grove', 'Betty', 'Lopez');

1 row created.

SQL> INSERT INTO PARTY VALUES (systimestamp-2+(1/24/60)*10, 'Grand Ballroom, Level 3, Continental Hotel', 'Ruth', 'Jones');

1 row created.

SQL> INSERT INTO PARTY VALUES (systimestamp+3+(1/24/60)*50, '27 Sentosa Cove', 'Brian', 'Parker');

1 row created.

SQL> INSERT INTO PARTY VALUES (systimestamp+25+(1/24/60)*25, '138 Clementi Road', 'Carol', 'Martin');

1 row created.

SQL> INSERT INTO PARTY VALUES (systimestamp+6+(1/24/60)*10, 'Orchid Room, Level 2, Raffles Hotel', 'Charles', 'Carter');

1 row created.

SQL> INSERT INTO PARTY VALUES (systimestamp+12+(1/24/60)*20, 'Grand Hall, Level 2, MBS', 'Jeff', 'Collins');

1 row created.

SQL> INSERT INTO PARTY VALUES (systimestamp+3+(1/24/60)*50, 'Grand Ballroom, Level 3, Continental Hotel', 'Paul', 'Anderson');

1 row created.

SQL> INSERT INTO PARTY VALUES (systimestamp+24+(1/24/60)*50, 'Grand Hall, Level 2, Mandarin Orchard Hotel', 'Susan', 'Lee');

1 row created.

SQL> INSERT INTO PARTY VALUES (systimestamp-2+(1/24/60)*120, '138 Holland Road', 'Karen', 'Hill');

1 row created.

SQL> INSERT INTO PARTY VALUES (systimestamp-1+(1/24/60)*10, 'Grand Ballroom, Level 3, Continental Hotel', 'John', 'Young');

1 row created.

SQL> INSERT INTO PARTY VALUES (systimestamp+12+(1/24/60)*100, 'Rose Garden, Singapore Botanical Garden', 'Kimberly', 'Brown');

1 row created.

SQL> INSERT INTO PARTY VALUES (systimestamp+21+(1/24/60)*180, 'Grand Ballroom, Level 3, Continental Hotel', 'Ronald', 'Lewis');

1 row created.

SQL> INSERT INTO PARTY VALUES (systimestamp+27+(1/24/60)*120, '10 Bukit Timah Road', 'Ruth', 'Jones');

1 row created.

SQL> INSERT INTO PARTY VALUES (systimestamp+7+(1/24/60)*48, '28 Upper Bukit Timah Road', 'Susan', 'Lee');

1 row created.

SQL> INSERT INTO PARTY VALUES (systimestamp+17+(1/24/60)*21, '110 Hamilton Park', 'Thomas', 'Taylor');

1 row created.

SQL> INSERT INTO PARTY VALUES (systimestamp+5+(1/24/60)*100, 'Grand Hall, Level 2, MBS', 'William', 'Young');

1 row created.

SQL> 
SQL> 
SQL> -- Create table Feedback
SQL> CREATE TABLE FEEDBACK (
  2  FbDate	     DATE
  3  	     CONSTRAINT      Feedback_FbDate_NotNull NOT NULL,
  4  FbComment		     VARCHAR2(1024)
  5  	     CONSTRAINT      Feedback_FbComment_NotNull NOT NULL,
  6  FbPtDateTime    TIMESTAMP
  7  	     CONSTRAINT      Feedback_FbPtDateTime_NotNull NOT NULL,
  8  FbPtLocation    VARCHAR2(75)
  9  	     CONSTRAINT Feedback_FbPtLocation_NotNull NOT NULL,
 10  FbClientFName   VARCHAR2(25)
 11  	     CONSTRAINT Feedback_FbClientFName_NotNull NOT NULL,
 12  FbClientLName   VARCHAR2(25)
 13  	     CONSTRAINT Feedback_FbClientLName_NotNull NOT NULL,
 14  CONSTRAINT      Feedback_PK PRIMARY KEY (FbPtDateTime, FbPtLocation, FbClientFName, FbClientLName),
 15  CONSTRAINT      Feedback_FK1 FOREIGN KEY (FbPtDateTime, FbPtLocation) REFERENCES PARTY (PartyDateTime, Location),
 16  CONSTRAINT      Feedback_FK2 FOREIGN KEY (FbClientFName, FbClientLName) REFERENCES CLIENT (ClientFName, ClientLName)
 17  );

Table created.

SQL> 
SQL> -- Insert sample records to Feedback
SQL> insert into feedback (FbPtDateTime, FbPtLocation, FbClientFName, FbClientLName, FbDate, FbComment) SELECT PartyDateTime, Location, ClientFName, ClientLName, PartyDateTime+2, 'Excellent Food!'
  2  from party
  3  where ClientFName = 'Anthony';

1 row created.

SQL> 
SQL> insert into feedback (FbPtDateTime, FbPtLocation, FbClientFName, FbClientLName, FbDate, FbComment) SELECT PartyDateTime, Location, ClientFName, ClientLName, PartyDateTime+2, 'Excellent Food and wonderful environment!'
  2  from party
  3  where ClientFName = 'Kevin';

3 rows created.

SQL> 
SQL> insert into feedback (FbPtDateTime, FbPtLocation, FbClientFName, FbClientLName, FbDate, FbComment) SELECT PartyDateTime, Location, ClientFName, ClientLName, PartyDateTime+1, 'Food is great, but Chef is not friently!'
  2  from party
  3  where ClientFName = 'Michelle';

1 row created.

SQL> 
SQL> insert into feedback (FbPtDateTime, FbPtLocation, FbClientFName, FbClientLName, FbDate, FbComment) SELECT PartyDateTime, Location, ClientFName, ClientLName, PartyDateTime+3, 'Satisfactory, will get the same Chef again!'
  2  from party
  3  where ClientFName = 'Betty';

2 rows created.

SQL> 
SQL> insert into feedback (FbPtDateTime, FbPtLocation, FbClientFName, FbClientLName, FbDate, FbComment) SELECT PartyDateTime, Location, ClientFName, ClientLName, PartyDateTime+2, 'Excellent Food!'
  2  from party
  3  where ClientFName = 'Ruth';

2 rows created.

SQL> 
SQL> insert into feedback (FbPtDateTime, FbPtLocation, FbClientFName, FbClientLName, FbDate, FbComment) SELECT PartyDateTime, Location, ClientFName, ClientLName, PartyDateTime+2, 'Lousy food! Will not use the organizer again'
  2  from party
  3  where ClientFName = 'Brian';

1 row created.

SQL> 
SQL> insert into feedback (FbPtDateTime, FbPtLocation, FbClientFName, FbClientLName, FbDate, FbComment) SELECT PartyDateTime, Location, ClientFName, ClientLName, PartyDateTime, 'Excellent Food! But too expensive'
  2  from party
  3  where ClientFName = 'Carol';

1 row created.

SQL> 
SQL> insert into feedback (FbPtDateTime, FbPtLocation, FbClientFName, FbClientLName, FbDate, FbComment) SELECT PartyDateTime, Location, ClientFName, ClientLName, PartyDateTime+3, 'No complain. Foods were wonderful. Definitely will get the same Chefs again!'
  2  from party
  3  where ClientFName = 'Charles';

1 row created.

SQL> 
SQL> insert into feedback (FbPtDateTime, FbPtLocation, FbClientFName, FbClientLName, FbDate, FbComment) SELECT PartyDateTime, Location, ClientFName, ClientLName, PartyDateTime+1, 'Excellent Food!'
  2  from party
  3  where ClientFName = 'Jeff';

1 row created.

SQL> 
SQL> insert into feedback (FbPtDateTime, FbPtLocation, FbClientFName, FbClientLName, FbDate, FbComment) SELECT PartyDateTime, Location, ClientFName, ClientLName, PartyDateTime+2, 'Wonderful!'
  2  from party
  3  where ClientFName = 'Paul';

1 row created.

SQL> 
SQL> insert into feedback (FbPtDateTime, FbPtLocation, FbClientFName, FbClientLName, FbDate, FbComment) SELECT PartyDateTime, Location, ClientFName, ClientLName, PartyDateTime+1, 'Great food! But quantity is rather small'
  2  from party
  3  where ClientFName = 'Susan';

2 rows created.

SQL> 
SQL> insert into feedback (FbPtDateTime, FbPtLocation, FbClientFName, FbClientLName, FbDate, FbComment) SELECT PartyDateTime, Location, ClientFName, ClientLName, PartyDateTime+2, 'No complain. Very satisfied with the services as well as the food!'
  2  from party
  3  where ClientFName = 'Karen';

1 row created.

SQL> 
SQL> insert into feedback (FbPtDateTime, FbPtLocation, FbClientFName, FbClientLName, FbDate, FbComment) SELECT PartyDateTime, Location, ClientFName, ClientLName, PartyDateTime+2, 'Excellent Food!'
  2  from party
  3  where ClientFName = 'John';

1 row created.

SQL> 
SQL> insert into feedback (FbPtDateTime, FbPtLocation, FbClientFName, FbClientLName, FbDate, FbComment) SELECT PartyDateTime, Location, ClientFName, ClientLName, PartyDateTime+3, 'Excellent Food! Service is good as well.'
  2  from party
  3  where ClientFName = 'Kimberly';

1 row created.

SQL> 
SQL> insert into feedback (FbPtDateTime, FbPtLocation, FbClientFName, FbClientLName, FbDate, FbComment) SELECT PartyDateTime, Location, ClientFName, ClientLName, PartyDateTime+1, 'Excellent Food!'
  2  from party
  3  where ClientFName = 'William';

1 row created.

SQL> 
SQL> -- Create table CHEFPARTY
SQL> CREATE TABLE CHEFPARTY (
  2  CpPtDateTime    TIMESTAMP
  3  	     CONSTRAINT      Feedback_CpPtDateTime_NotNull NOT NULL,
  4  CpPtLocation    VARCHAR2(75)
  5  	     CONSTRAINT Feedback_CpPtLocation_NotNull NOT NULL,
  6  CpChefFName     VARCHAR2(25)
  7  	     CONSTRAINT Feedback_CpChefFName_NotNull NOT NULL,
  8  CpChefLName     VARCHAR2(25)
  9  	     CONSTRAINT Feedback_CpChefLName_NotNull NOT NULL,
 10  CONSTRAINT      ChefParty_PK PRIMARY KEY (CpPtDateTime, CpPtLocation, CpChefFName, CpChefLName),
 11  CONSTRAINT      ChefParty_FK1 FOREIGN KEY (CpPtDateTime, CpPtLocation) REFERENCES PARTY (PartyDateTime, Location),
 12  CONSTRAINT      ChefParty_FK2 FOREIGN KEY (CpChefFName, CpChefLName) REFERENCES CHEF (ChefFName, ChefLName)
 13  );

Table created.

SQL> 
SQL> insert into CHEFPARTY (CpPtDateTime, CpPtLocation, CpChefFName, CpChefLName)
  2  SELECT PartyDateTime, Location, ChefFName, ChefLName
  3  from party, chef
  4  where ClientFName = 'William'
  5  and ChefFName = 'Daniel';

1 row created.

SQL> 
SQL> insert into CHEFPARTY (CpPtDateTime, CpPtLocation, CpChefFName, CpChefLName)
  2  SELECT PartyDateTime, Location, ChefFName, ChefLName
  3  from party, chef
  4  where ClientFName = 'Thomas'
  5  and ChefFName = 'Daniel';

1 row created.

SQL> 
SQL> insert into CHEFPARTY (CpPtDateTime, CpPtLocation, CpChefFName, CpChefLName)
  2  SELECT PartyDateTime, Location, ChefFName, ChefLName
  3  from party, chef
  4  where ClientFName = 'Susan'
  5  and ChefFName = 'Eric';

2 rows created.

SQL> 
SQL> insert into CHEFPARTY (CpPtDateTime, CpPtLocation, CpChefFName, CpChefLName)
  2  SELECT PartyDateTime, Location, ChefFName, ChefLName
  3  from party, chef
  4  where ClientFName = 'Ruth'
  5  and ChefFName = 'Brian'
  6  and location = 'Grand Ballroom, Level 3, Continental Hotel';

1 row created.

SQL> 
SQL> insert into CHEFPARTY (CpPtDateTime, CpPtLocation, CpChefFName, CpChefLName)
  2  SELECT PartyDateTime, Location, ChefFName, ChefLName
  3  from party, chef
  4  where ClientFName = 'Ronald'
  5  and ChefFName = 'Dennis';

1 row created.

SQL> 
SQL> insert into CHEFPARTY (CpPtDateTime, CpPtLocation, CpChefFName, CpChefLName)
  2  SELECT PartyDateTime, Location, ChefFName, ChefLName
  3  from party, chef
  4  where ClientFName = 'Kimberly'
  5  and ChefFName = 'Helen';

1 row created.

SQL> 
SQL> insert into CHEFPARTY (CpPtDateTime, CpPtLocation, CpChefFName, CpChefLName)
  2  SELECT PartyDateTime, Location, ChefFName, ChefLName
  3  from party, chef
  4  where ClientFName = 'Kimberly'
  5  and ChefFName = 'Victor';

1 row created.

SQL> 
SQL> insert into CHEFPARTY (CpPtDateTime, CpPtLocation, CpChefFName, CpChefLName)
  2  SELECT PartyDateTime, Location, ChefFName, ChefLName
  3  from party, chef
  4  where ClientFName = 'John'
  5  and ChefFName = 'Jerry';

1 row created.

SQL> 
SQL> insert into CHEFPARTY (CpPtDateTime, CpPtLocation, CpChefFName, CpChefLName)
  2  SELECT PartyDateTime, Location, ChefFName, ChefLName
  3  from party, chef
  4  where ClientFName = 'Karen'
  5  and ChefFName = 'Daniel';

1 row created.

SQL> 
SQL> insert into CHEFPARTY (CpPtDateTime, CpPtLocation, CpChefFName, CpChefLName)
  2  SELECT PartyDateTime, Location, ChefFName, ChefLName
  3  from party, chef
  4  where ClientFName = 'Susan'
  5  and ChefFName = 'Pamela';

2 rows created.

SQL> 
SQL> insert into CHEFPARTY (CpPtDateTime, CpPtLocation, CpChefFName, CpChefLName)
  2  SELECT PartyDateTime, Location, ChefFName, ChefLName
  3  from party, chef
  4  where ClientFName = 'Paul'
  5  and ChefFName = 'Pamela';

1 row created.

SQL> 
SQL> insert into CHEFPARTY (CpPtDateTime, CpPtLocation, CpChefFName, CpChefLName)
  2  SELECT PartyDateTime, Location, ChefFName, ChefLName
  3  from party, chef
  4  where ClientFName = 'Jeff'
  5  and ChefFName = 'Helen';

1 row created.

SQL> 
SQL> insert into CHEFPARTY (CpPtDateTime, CpPtLocation, CpChefFName, CpChefLName)
  2  SELECT PartyDateTime, Location, ChefFName, ChefLName
  3  from party, chef
  4  where ClientFName = 'Jeff'
  5  and ChefFName = 'Dennis';

1 row created.

SQL> 
SQL> insert into CHEFPARTY (CpPtDateTime, CpPtLocation, CpChefFName, CpChefLName)
  2  SELECT PartyDateTime, Location, ChefFName, ChefLName
  3  from party, chef
  4  where ClientFName = 'Jeff'
  5  and ChefFName = 'Victor';

1 row created.

SQL> 
SQL> insert into CHEFPARTY (CpPtDateTime, CpPtLocation, CpChefFName, CpChefLName)
  2  SELECT PartyDateTime, Location, ChefFName, ChefLName
  3  from party, chef
  4  where ClientFName = 'Charles'
  5  and ChefFName = 'Brian';

1 row created.

SQL> 
SQL> insert into CHEFPARTY (CpPtDateTime, CpPtLocation, CpChefFName, CpChefLName)
  2  SELECT PartyDateTime, Location, ChefFName, ChefLName
  3  from party, chef
  4  where ClientFName = 'Charles'
  5  and ChefFName = 'Helen';

1 row created.

SQL> 
SQL> insert into CHEFPARTY (CpPtDateTime, CpPtLocation, CpChefFName, CpChefLName)
  2  SELECT PartyDateTime, Location, ChefFName, ChefLName
  3  from party, chef
  4  where ClientFName = 'Carol'
  5  and ChefFName = 'Victor';

1 row created.

SQL> 
SQL> insert into CHEFPARTY (CpPtDateTime, CpPtLocation, CpChefFName, CpChefLName)
  2  SELECT PartyDateTime, Location, ChefFName, ChefLName
  3  from party, chef
  4  where ClientFName = 'Brian'
  5  and ChefFName = 'Daniel';

1 row created.

SQL> 
SQL> insert into CHEFPARTY (CpPtDateTime, CpPtLocation, CpChefFName, CpChefLName)
  2  SELECT PartyDateTime, Location, ChefFName, ChefLName
  3  from party, chef
  4  where ClientFName = 'Betty'
  5  and ChefFName = 'Pamela';

2 rows created.

SQL> 
SQL> insert into CHEFPARTY (CpPtDateTime, CpPtLocation, CpChefFName, CpChefLName)
  2  SELECT PartyDateTime, Location, ChefFName, ChefLName
  3  from party, chef
  4  where ClientFName = 'Kevin'
  5  and ChefFName = 'Dennis'
  6  and location = 'Grand Hall, Level 2, Mandarin Orchard Hotel';

1 row created.

SQL> 
SQL> insert into CHEFPARTY (CpPtDateTime, CpPtLocation, CpChefFName, CpChefLName)
  2  SELECT PartyDateTime, Location, ChefFName, ChefLName
  3  from party, chef
  4  where ClientFName = 'Kevin'
  5  and ChefFName = 'Daniel'
  6  and location = 'Grand Hall, Level 2, Mandarin Orchard Hotel';

1 row created.

SQL> 
SQL> insert into CHEFPARTY (CpPtDateTime, CpPtLocation, CpChefFName, CpChefLName)
  2  SELECT PartyDateTime, Location, ChefFName, ChefLName
  3  from party, chef
  4  where ClientFName = 'Kevin'
  5  and ChefFName = 'Daniel'
  6  and location = 'Grand Hall, Level 2, MBS';

1 row created.

SQL> 
SQL> insert into CHEFPARTY (CpPtDateTime, CpPtLocation, CpChefFName, CpChefLName)
  2  SELECT PartyDateTime, Location, ChefFName, ChefLName
  3  from party, chef
  4  where ClientFName = 'Kevin'
  5  and ChefFName = 'Helen'
  6  and location = 'Grand Hall, Level 2, MBS';

1 row created.

SQL> 
SQL> insert into CHEFPARTY (CpPtDateTime, CpPtLocation, CpChefFName, CpChefLName)
  2  SELECT PartyDateTime, Location, ChefFName, ChefLName
  3  from party, chef
  4  where ClientFName = 'Kevin'
  5  and ChefFName = 'Daniel'
  6  and location = '14 West Coast Park Road';

1 row created.

SQL> 
SQL> insert into CHEFPARTY (CpPtDateTime, CpPtLocation, CpChefFName, CpChefLName)
  2  SELECT PartyDateTime, Location, ChefFName, ChefLName
  3  from party, chef
  4  where ClientFName = 'Kevin'
  5  and ChefFName = 'Sarah'
  6  and location = 'Grand Hall, Level 2, MBS';

1 row created.

SQL> 
SQL> insert into CHEFPARTY (CpPtDateTime, CpPtLocation, CpChefFName, CpChefLName)
  2  SELECT PartyDateTime, Location, ChefFName, ChefLName
  3  from party, chef
  4  where ClientFName = 'Anthony'
  5  and ChefFName = 'Pamela';

1 row created.

SQL> 
SQL> insert into CHEFPARTY (CpPtDateTime, CpPtLocation, CpChefFName, CpChefLName)
  2  SELECT PartyDateTime, Location, ChefFName, ChefLName
  3  from party, chef
  4  where ClientFName = 'Anthony'
  5  and ChefFName = 'Sarah';

1 row created.

SQL> 
SQL> insert into CHEFPARTY (CpPtDateTime, CpPtLocation, CpChefFName, CpChefLName)
  2  SELECT PartyDateTime, Location, ChefFName, ChefLName
  3  from party, chef
  4  where ClientFName = 'Michelle'
  5  and ChefFName = 'Jerry';

1 row created.

SQL> 
SQL> -- spool off
SQL> 
SQL> 
SQL> 
SQL> -- List the full details and age of all chefs
SQL> -- who are between 21 and 40 years old.
SQL> 
SQL> -- To list values from chef
SQL> SELECT * FROM CHEF;

CHEFFNAME                 CHEFLNAME                 S DOB                       
------------------------- ------------------------- - ---------                 
Daniel                    Lee                       M 10-MAR-68                 
Brian                     Miller                    M 04-SEP-75                 
Eric                      Harris                    M 15-APR-92                 
Andrew                    Smith                     M 25-JUL-80                 
Jerry                     Walker                    M 23-FEB-92                 
Dennis                    Jenkins                   M 19-OCT-89                 
Victor                    Myers                     M 01-MAY-85                 
Helen                     Perry                     F 30-MAR-85                 
Sarah                     Foster                    F 11-NOV-89                 
Pamela                    Miyuki                    F 12-JUN-88                 
Donald                    Lewis                     M 18-AUG-80                 

CHEFFNAME                 CHEFLNAME                 S DOB                       
------------------------- ------------------------- - ---------                 
Anita                     Baker                     F 27-SEP-81                 

12 rows selected.

SQL> 
SQL> SELECT CHEFFNAME, CHEFLNAME, SEX, DOB,
  2  TRUNC (months_between(SYSDATE, DOB)/12) AS AGE
  3  FROM CHEF
  4  WHERE TRUNC (months_between(SYSDATE, DOB)/12) > 20
  5  AND TRUNC (months_between(SYSDATE, DOB)/12) < 41;

CHEFFNAME                 CHEFLNAME                 S DOB              AGE      
------------------------- ------------------------- - --------- ----------      
Eric                      Harris                    M 15-APR-92         26      
Andrew                    Smith                     M 25-JUL-80         37      
Jerry                     Walker                    M 23-FEB-92         26      
Dennis                    Jenkins                   M 19-OCT-89         28      
Victor                    Myers                     M 01-MAY-85         33      
Helen                     Perry                     F 30-MAR-85         33      
Sarah                     Foster                    F 11-NOV-89         28      
Pamela                    Miyuki                    F 12-JUN-88         29      
Donald                    Lewis                     M 18-AUG-80         37      
Anita                     Baker                     F 27-SEP-81         36      

10 rows selected.

SQL> 
SQL> --================END OF Qn 5(a)=================
SQL> 
SQL> --===================Qn 5(b)=====================
SQL> 
SQL> --List the client first and last name, email,
SQL> -- and a total number of parties each client held.
SQL> 
SQL> -- To check constraints
SQL> DESC CLIENT;
 Name                                      Null?    Type
 ----------------------------------------- -------- ----------------------------
 CLIENTFNAME                               NOT NULL VARCHAR2(25)
 CLIENTLNAME                               NOT NULL VARCHAR2(25)
 PHONE                                              VARCHAR2(25)
 CLIENTEMAIL                               NOT NULL VARCHAR2(75)
 SEX                                       NOT NULL VARCHAR2(1)

SQL> DESC PARTY;
 Name                                      Null?    Type
 ----------------------------------------- -------- ----------------------------
 PARTYDATETIME                             NOT NULL TIMESTAMP(6)
 LOCATION                                  NOT NULL VARCHAR2(75)
 CLIENTFNAME                               NOT NULL VARCHAR2(25)
 CLIENTLNAME                               NOT NULL VARCHAR2(25)

SQL> 
SQL> -- To verify how many clients in the table
SQL> SELECT COUNT(CLIENTFNAME)
  2  AS CLIENTCOUNT
  3  FROM CLIENT;

CLIENTCOUNT                                                                     
-----------                                                                     
         20                                                                     

1 row selected.

SQL> 
SQL> -- To verify total number of parties in the table
SQL> SELECT COUNT(CLIENTFNAME)
  2  AS CLIENTCOUNT
  3  FROM PARTY;

CLIENTCOUNT                                                                     
-----------                                                                     
         22                                                                     

1 row selected.

SQL> 
SQL> SELECT CLIENT.CLIENTFNAME, CLIENT.CLIENTLNAME,
  2  CLIENT.CLIENTEMAIL, COUNT(PARTY.PARTYDATETIME)
  3  AS PARTYCOUNT
  4  FROM CLIENT, PARTY
  5  WHERE ((CLIENT.CLIENTFNAME = PARTY.CLIENTFNAME)
  6  AND (CLIENT.CLIENTLNAME = PARTY.CLIENTLNAME))
  7  GROUP BY (CLIENT.CLIENTFNAME, CLIENT.CLIENTLNAME,
  8  CLIENT.CLIENTEMAIL)
  9  UNION
 10  SELECT CLIENTFNAME, CLIENTLNAME, CLIENTEMAIL, 0
 11  FROM CLIENT
 12  WHERE (CLIENTFNAME, CLIENTLNAME) NOT IN
 13  (SELECT CLIENTFNAME, CLIENTLNAME
 14  FROM PARTY);

CLIENTFNAME               CLIENTLNAME                                           
------------------------- -------------------------                             
CLIENTEMAIL                                                                     
---------------------------------------------------------------------------     
PARTYCOUNT                                                                      
----------                                                                      
Anthony                   White                                                 
awhite@gmail.com                                                                
         1                                                                      
                                                                                
Betty                     Lopez                                                 
blopez@gmail.com                                                                
         2                                                                      

CLIENTFNAME               CLIENTLNAME                                           
------------------------- -------------------------                             
CLIENTEMAIL                                                                     
---------------------------------------------------------------------------     
PARTYCOUNT                                                                      
----------                                                                      
                                                                                
Brian                     Parker                                                
bparker@yahoo.com                                                               
         1                                                                      
                                                                                
Carol                     Martin                                                
cmartin@gmail.com                                                               

CLIENTFNAME               CLIENTLNAME                                           
------------------------- -------------------------                             
CLIENTEMAIL                                                                     
---------------------------------------------------------------------------     
PARTYCOUNT                                                                      
----------                                                                      
         1                                                                      
                                                                                
Charles                   Carter                                                
ccarter@gmail.com                                                               
         1                                                                      
                                                                                
Deborah                   Nelson                                                

CLIENTFNAME               CLIENTLNAME                                           
------------------------- -------------------------                             
CLIENTEMAIL                                                                     
---------------------------------------------------------------------------     
PARTYCOUNT                                                                      
----------                                                                      
dnelson@yahoo.com                                                               
         0                                                                      
                                                                                
Jeff                      Collins                                               
jcollins@gmail.com                                                              
         1                                                                      
                                                                                

CLIENTFNAME               CLIENTLNAME                                           
------------------------- -------------------------                             
CLIENTEMAIL                                                                     
---------------------------------------------------------------------------     
PARTYCOUNT                                                                      
----------                                                                      
Jennifer                  Baker                                                 
jbaker@yahoo.com                                                                
         0                                                                      
                                                                                
John                      Young                                                 
jyoung@gmail.com                                                                
         1                                                                      

CLIENTFNAME               CLIENTLNAME                                           
------------------------- -------------------------                             
CLIENTEMAIL                                                                     
---------------------------------------------------------------------------     
PARTYCOUNT                                                                      
----------                                                                      
                                                                                
Karen                     Hill                                                  
khill@gmail.com                                                                 
         1                                                                      
                                                                                
Kevin                     Gonzalez                                              
kgonzalez@gmail.com                                                             

CLIENTFNAME               CLIENTLNAME                                           
------------------------- -------------------------                             
CLIENTEMAIL                                                                     
---------------------------------------------------------------------------     
PARTYCOUNT                                                                      
----------                                                                      
         3                                                                      
                                                                                
Kimberly                  Brown                                                 
kbrown@gmail.com                                                                
         1                                                                      
                                                                                
Kimberly                  Scott                                                 

CLIENTFNAME               CLIENTLNAME                                           
------------------------- -------------------------                             
CLIENTEMAIL                                                                     
---------------------------------------------------------------------------     
PARTYCOUNT                                                                      
----------                                                                      
kscott@gmail.com                                                                
         0                                                                      
                                                                                
Michelle                  Moore                                                 
mmoore@gmail.com                                                                
         1                                                                      
                                                                                

CLIENTFNAME               CLIENTLNAME                                           
------------------------- -------------------------                             
CLIENTEMAIL                                                                     
---------------------------------------------------------------------------     
PARTYCOUNT                                                                      
----------                                                                      
Paul                      Anderson                                              
panderson@yahoo.com                                                             
         1                                                                      
                                                                                
Ronald                    Lewis                                                 
rlewis@gmail.com                                                                
         1                                                                      

CLIENTFNAME               CLIENTLNAME                                           
------------------------- -------------------------                             
CLIENTEMAIL                                                                     
---------------------------------------------------------------------------     
PARTYCOUNT                                                                      
----------                                                                      
                                                                                
Ruth                      Jones                                                 
rjones@gmail.com                                                                
         2                                                                      
                                                                                
Susan                     Lee                                                   
slee@gmail.com                                                                  

CLIENTFNAME               CLIENTLNAME                                           
------------------------- -------------------------                             
CLIENTEMAIL                                                                     
---------------------------------------------------------------------------     
PARTYCOUNT                                                                      
----------                                                                      
         2                                                                      
                                                                                
Thomas                    Taylor                                                
ttaylor@yahoo.com                                                               
         1                                                                      
                                                                                
William                   Young                                                 

CLIENTFNAME               CLIENTLNAME                                           
------------------------- -------------------------                             
CLIENTEMAIL                                                                     
---------------------------------------------------------------------------     
PARTYCOUNT                                                                      
----------                                                                      
wyoung@gmail.com                                                                
         1                                                                      
                                                                                

20 rows selected.

SQL> 
SQL> --================END OF Qn 5(b)=================
SQL> 
SQL> --=====================Qn 5(c)===================
SQL> 
SQL> -- List the first name, last name and the total number
SQL> -- of chef’s engagements in the parties.
SQL> -- Do not ignore chefs who have not engaged in
SQL> -- any party before.
SQL> 
SQL> -- To check constraints
SQL> SELECT TABLE_NAME FROM USER_TABLES;

TABLE_NAME                                                                      
------------------------------                                                  
PHARMACEUTICAL                                                                  
DOCTOR                                                                          
PATIENT                                                                         
DRUG                                                                            
PHARMACIST                                                                      
CHEF                                                                            
SPECIALITY                                                                      
CLIENT                                                                          
PARTY                                                                           
FEEDBACK                                                                        
CHEFPARTY                                                                       

TABLE_NAME                                                                      
------------------------------                                                  
PRESCRIPTION                                                                    

12 rows selected.

SQL> DESC CHEFPARTY;
 Name                                      Null?    Type
 ----------------------------------------- -------- ----------------------------
 CPPTDATETIME                              NOT NULL TIMESTAMP(6)
 CPPTLOCATION                              NOT NULL VARCHAR2(75)
 CPCHEFFNAME                               NOT NULL VARCHAR2(25)
 CPCHEFLNAME                               NOT NULL VARCHAR2(25)

SQL> DESC CHEF;
 Name                                      Null?    Type
 ----------------------------------------- -------- ----------------------------
 CHEFFNAME                                 NOT NULL VARCHAR2(25)
 CHEFLNAME                                 NOT NULL VARCHAR2(25)
 SEX                                       NOT NULL VARCHAR2(1)
 DOB                                                DATE

SQL> DESC PARTY;
 Name                                      Null?    Type
 ----------------------------------------- -------- ----------------------------
 PARTYDATETIME                             NOT NULL TIMESTAMP(6)
 LOCATION                                  NOT NULL VARCHAR2(75)
 CLIENTFNAME                               NOT NULL VARCHAR2(25)
 CLIENTLNAME                               NOT NULL VARCHAR2(25)

SQL> 
SQL> -- To verify number of chefs in the table
SQL> SELECT COUNT(CHEFFNAME) AS TOTALCHEFCOUNT
  2  FROM CHEF;

TOTALCHEFCOUNT                                                                  
--------------                                                                  
            12                                                                  

1 row selected.

SQL> 
SQL> -- To verify total chefs involved in parties
SQL> SELECT COUNT(CPCHEFFNAME) AS CHEFPARTYCOUNT
  2  FROM CHEFPARTY;

CHEFPARTYCOUNT                                                                  
--------------                                                                  
            31                                                                  

1 row selected.

SQL> 
SQL> SELECT CPCHEFFNAME, CPCHEFLNAME, COUNT(CPCHEFFNAME)
  2  AS PARTYCOUNT
  3  FROM CHEFPARTY
  4  GROUP BY CPCHEFFNAME, CPCHEFLNAME
  5  UNION
  6  SELECT CHEFFNAME, CHEFLNAME, 0
  7  FROM CHEF
  8  WHERE (CHEFFNAME, CHEFLNAME) NOT IN
  9  (SELECT CPCHEFFNAME, CPCHEFLNAME
 10  FROM CHEFPARTY);

CPCHEFFNAME               CPCHEFLNAME               PARTYCOUNT                  
------------------------- ------------------------- ----------                  
Andrew                    Smith                              0                  
Anita                     Baker                              0                  
Brian                     Miller                             2                  
Daniel                    Lee                                7                  
Dennis                    Jenkins                            3                  
Donald                    Lewis                              0                  
Eric                      Harris                             2                  
Helen                     Perry                              4                  
Jerry                     Walker                             2                  
Pamela                    Miyuki                             6                  
Sarah                     Foster                             2                  

CPCHEFFNAME               CPCHEFLNAME               PARTYCOUNT                  
------------------------- ------------------------- ----------                  
Victor                    Myers                              3                  

12 rows selected.

SQL> 
SQL> --================END OF Qn 5(c)=================
SQL> 
SQL> --=====================Qn 5(d)===================
SQL> 
SQL> -- For all chefs who have not been engaged in any party
SQL> -- list the chef’s first and last name together
SQL> -- with his/her speciality.
SQL> -- Order your output by speciality.
SQL> 
SQL> SELECT CHEFFNAME, CHEFLNAME, SPECIALITY
  2  FROM SPECIALITY
  3  WHERE (CHEFFNAME, CHEFLNAME) NOT IN
  4  (SELECT CPCHEFFNAME, CPCHEFLNAME
  5  FROM CHEFPARTY)
  6  ORDER BY SPECIALITY;

CHEFFNAME                 CHEFLNAME                                             
------------------------- -------------------------                             
SPECIALITY                                                                      
--------------------------------------------------                              
Donald                    Lewis                                                 
Dutch Cuisine                                                                   
                                                                                
Andrew                    Smith                                                 
French Cuisine                                                                  
                                                                                
Andrew                    Smith                                                 
Italian Cuisine                                                                 
                                                                                

CHEFFNAME                 CHEFLNAME                                             
------------------------- -------------------------                             
SPECIALITY                                                                      
--------------------------------------------------                              
Anita                     Baker                                                 
New Zealand Cuisine                                                             
                                                                                

4 rows selected.

SQL> 
SQL> --================END OF Qn 5(d)=================
SQL> 
SQL> --=====================Qn 5(e)===================
SQL> 
SQL> -- List the full details of the chefs
SQL> -- who specialise in both ‘Chinese Cuisine’
SQL> -- and ‘Japanese Cuisine’.
SQL> 
SQL> SELECT *
  2  FROM CHEF
  3  WHERE (CHEFFNAME, CHEFLNAME) IN
  4  (SELECT CHEFFNAME, CHEFLNAME
  5  FROM SPECIALITY
  6  WHERE SPECIALITY = 'Chinese Cuisine'
  7  INTERSECT
  8  SELECT CHEFFNAME, CHEFLNAME
  9  FROM SPECIALITY
 10  WHERE SPECIALITY = 'Japanese Cuisine');

CHEFFNAME                 CHEFLNAME                 S DOB                       
------------------------- ------------------------- - ---------                 
Daniel                    Lee                       M 10-MAR-68                 

1 row selected.

SQL> 
SQL> --================END OF Qn 5(e)=================
SQL> 
SQL> --=====================Qn 5(f)===================
SQL> 
SQL> -- List the first name and last name of the chefs
SQL> -- who have been engaged by the clients Charles Carter
SQL> -- or John Young.
SQL> 
SQL> -- Checking constraints
SQL> DESC CLIENT;
 Name                                      Null?    Type
 ----------------------------------------- -------- ----------------------------
 CLIENTFNAME                               NOT NULL VARCHAR2(25)
 CLIENTLNAME                               NOT NULL VARCHAR2(25)
 PHONE                                              VARCHAR2(25)
 CLIENTEMAIL                               NOT NULL VARCHAR2(75)
 SEX                                       NOT NULL VARCHAR2(1)

SQL> DESC PARTY;
 Name                                      Null?    Type
 ----------------------------------------- -------- ----------------------------
 PARTYDATETIME                             NOT NULL TIMESTAMP(6)
 LOCATION                                  NOT NULL VARCHAR2(75)
 CLIENTFNAME                               NOT NULL VARCHAR2(25)
 CLIENTLNAME                               NOT NULL VARCHAR2(25)

SQL> DESC CHEFPARTY;
 Name                                      Null?    Type
 ----------------------------------------- -------- ----------------------------
 CPPTDATETIME                              NOT NULL TIMESTAMP(6)
 CPPTLOCATION                              NOT NULL VARCHAR2(75)
 CPCHEFFNAME                               NOT NULL VARCHAR2(25)
 CPCHEFLNAME                               NOT NULL VARCHAR2(25)

SQL> DESC CHEF;
 Name                                      Null?    Type
 ----------------------------------------- -------- ----------------------------
 CHEFFNAME                                 NOT NULL VARCHAR2(25)
 CHEFLNAME                                 NOT NULL VARCHAR2(25)
 SEX                                       NOT NULL VARCHAR2(1)
 DOB                                                DATE

SQL> 
SQL> SELECT CHEFFNAME, CHEFLNAME
  2  FROM CHEF
  3  WHERE (CHEFFNAME, CHEFLNAME) IN
  4  (SELECT CPCHEFFNAME, CPCHEFLNAME
  5  FROM CHEFPARTY
  6  WHERE (CPPTDATETIME, CPPTLOCATION) IN
  7  (SELECT PARTYDATETIME, LOCATION
  8  FROM PARTY
  9  WHERE (CLIENTFNAME, CLIENTLNAME) IN
 10  (SELECT CLIENTFNAME, CLIENTLNAME
 11  FROM CLIENT
 12  WHERE ((CLIENTFNAME = 'Charles')
 13  AND (CLIENTLNAME = 'Carter'))
 14  OR ((CLIENTFNAME = 'John')
 15  AND (CLIENTLNAME = 'Young')))));

CHEFFNAME                 CHEFLNAME                                             
------------------------- -------------------------                             
Brian                     Miller                                                
Helen                     Perry                                                 
Jerry                     Walker                                                

3 rows selected.

SQL> 
SQL> --================END OF Qn 5(f)=================
SQL> 
SQL> --=====================Qn 5(g)===================
SQL> 
SQL> -- List the full details of the chefs who have been engaged
SQL> -- in any party for more than 2 times.
SQL> -- Order the output by the chef’s last name
SQL> -- followed by first name.
SQL> 
SQL> SELECT *
  2  FROM CHEF
  3  WHERE (CHEFFNAME, CHEFLNAME) IN
  4  (SELECT CPCHEFFNAME, CPCHEFLNAME
  5  FROM CHEFPARTY
  6  GROUP BY (CPCHEFFNAME, CPCHEFLNAME)
  7  HAVING COUNT(*) > 2)
  8  ORDER BY CHEFFNAME, CHEFLNAME;

CHEFFNAME                 CHEFLNAME                 S DOB                       
------------------------- ------------------------- - ---------                 
Daniel                    Lee                       M 10-MAR-68                 
Dennis                    Jenkins                   M 19-OCT-89                 
Helen                     Perry                     F 30-MAR-85                 
Pamela                    Miyuki                    F 12-JUN-88                 
Victor                    Myers                     M 01-MAY-85                 

5 rows selected.

SQL> 
SQL> --================END OF Qn 5(g)=================
SQL> 
SQL> --=====================Qn 5(h)===================
SQL> 
SQL> -- List the most possessed speciality together with
SQL> -- the total number of chefs who specialize
SQL> -- in the speciality.
SQL> 
SQL> SELECT SPECIALITY, COUNT(CHEFFNAME)
  2  AS CHEFCOUNT
  3  FROM SPECIALITY
  4  GROUP BY SPECIALITY
  5  HAVING COUNT(SPECIALITY) =
  6  (SELECT MAX(COUNT(SPECIALITY))
  7  FROM SPECIALITY
  8  GROUP BY SPECIALITY);

SPECIALITY                                          CHEFCOUNT                   
-------------------------------------------------- ----------                   
Japanese Cuisine                                            3                   

1 row selected.

SQL> 
SQL> --================END OF Qn 5(h)=================
SQL> 
SQL> --=====================Qn 5(i)===================
SQL> 
SQL> -- List the full details of the chefs who have been
SQL> -- engaged in a party in May 2018 at Grand Hall,
SQL> -- level 2, MBS.
SQL> 
SQL> -- Checking constraints
SQL> 
SQL> DESC CHEF;
 Name                                      Null?    Type
 ----------------------------------------- -------- ----------------------------
 CHEFFNAME                                 NOT NULL VARCHAR2(25)
 CHEFLNAME                                 NOT NULL VARCHAR2(25)
 SEX                                       NOT NULL VARCHAR2(1)
 DOB                                                DATE

SQL> DESC CHEFPARTY;
 Name                                      Null?    Type
 ----------------------------------------- -------- ----------------------------
 CPPTDATETIME                              NOT NULL TIMESTAMP(6)
 CPPTLOCATION                              NOT NULL VARCHAR2(75)
 CPCHEFFNAME                               NOT NULL VARCHAR2(25)
 CPCHEFLNAME                               NOT NULL VARCHAR2(25)

SQL> 
SQL> SELECT *
  2  FROM CHEF
  3  WHERE (CHEFFNAME, CHEFLNAME) IN
  4  (SELECT CPCHEFFNAME, CPCHEFLNAME
  5  FROM CHEFPARTY
  6  WHERE ((TO_CHAR(CPPTDATETIME, 'YYYY-MM') = '2018-05')
  7  AND (CPPTLOCATION = 'Grand Hall, Level 2, MBS')));

CHEFFNAME                 CHEFLNAME                 S DOB                       
------------------------- ------------------------- - ---------                 
Sarah                     Foster                    F 11-NOV-89                 
Dennis                    Jenkins                   M 19-OCT-89                 
Daniel                    Lee                       M 10-MAR-68                 
Pamela                    Miyuki                    F 12-JUN-88                 
Victor                    Myers                     M 01-MAY-85                 
Helen                     Perry                     F 30-MAR-85                 

6 rows selected.

SQL> 
SQL> --================END OF Qn 5(i)=================
SQL> 
SQL> --=====================Qn 5(j)===================
SQL> 
SQL> -- For all most engaged chefs, list the firstname,
SQL> -- lastname, and the total number of time a chef is
SQL> -- engaged. By most engaged, it means chefs who
SQL> -- has been engaged in any party the most number of time.
SQL> 
SQL> SELECT CPCHEFFNAME, CPCHEFLNAME, COUNT(*)
  2  AS ENGAGECOUNT
  3  FROM CHEFPARTY
  4  GROUP BY (CPCHEFFNAME, CPCHEFLNAME)
  5  HAVING COUNT(*) IN
  6  (SELECT MAX(COUNT(*))
  7  FROM CHEFPARTY
  8  GROUP BY CPCHEFFNAME, CPCHEFLNAME);

CPCHEFFNAME               CPCHEFLNAME               ENGAGECOUNT                 
------------------------- ------------------------- -----------                 
Daniel                    Lee                                 7                 

1 row selected.

SQL> 
SQL> --================END OF Qn 5(j)=================
SQL> 
SQL> SPOOL OFF;
